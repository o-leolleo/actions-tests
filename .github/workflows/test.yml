name: Tests
run-name: Testing actions
on:
  push:
    branches:
    - main
jobs:
  changed-files:
    name: Changed files
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: read
    outputs:
      app: ${{ steps.filter.outputs.app }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Identify changed files
        uses: dorny/paths-filter@v2
        id: filter
        with:
          filters: |
            app:
              - 'README.md'
  test:
    runs-on: ubuntu-latest
    needs: changed-files
    if: needs.changed-files.outputs.app == 'true'
    steps:
      - run: |
          echo running tests
  run-metadata:
    runs-on: ubuntu-latest
    needs: test
    steps:
      - env:
          GITHUB: ${{ toJSON(github) }}
        run: |
          echo "${GITHUB}" | jq 'del(.token)|{root: .}' > github-workflow-root.json
      - name: upload root info
        uses: actions/upload-artifact@v3
        with:
          name: gh-root-meta
          path: github-workflow-root.json
          retention-days: 1
